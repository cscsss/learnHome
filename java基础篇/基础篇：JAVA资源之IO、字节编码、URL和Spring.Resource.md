<section id="nice" data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px; color: black; padding: 0 10px; line-height: 1.6; word-spacing: 0px; letter-spacing: 0px; word-break: break-word; word-wrap: break-word; text-align: left; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, 'PingFang SC', Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;"><h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">1 JAVA.IO字节流</span><span class="suffix"></span></h1>
<figure data-tool="mdnice编辑器" style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"><img src="http://ww1.sinaimg.cn/large/0064jPu8ly1ghcfilr3icj30r70gdq55.jpg" alt="inputstream.png" style="display: block; margin: 0 auto; max-width: 100%;"><figcaption style="margin-top: 5px; text-align: center; color: #888; font-size: 14px;">inputstream.png</figcaption></figure>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">LineNumberInputStream和StringBufferInputStream官方建议不再使用，推荐使用LineNumberReader和StringReader代替</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">ByteArrayInputStream和ByteArrayOutputStream
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">字节数组处理流，在内存中建立一个缓冲区作为流使用，从缓存区读取数据比从存储介质(如磁盘)的速率快</section></li></ul>
</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//用ByteArrayOutputStream暂时缓存来自其他渠道的数据</span>
<span/>ByteArrayOutputStream data = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> ByteArrayOutputStream(<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">1024</span>); <span class="hljs-comment" style="color: #007400; line-height: 26px;">//1024字节大小的缓存区</span>
<span/>data.write(System.in.read()); <span class="hljs-comment" style="color: #007400; line-height: 26px;">// 暂存用户输入数据</span>
<span/>
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//将data转为ByteArrayInputStream</span>
<span/>ByteArrayInputStream in = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> ByteArrayInputStream(data.toByteArray());
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">FileInputStream和FileOutputStream
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">访问文件，把文件作为InputStream，实现对文件的读写操作</section></li></ul>
</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">ObjectInputStream和ObjectOutputStream
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">对象流，构造函数需要传入一个流，实现对JAVA对象的读写功能；可用于序列化，而对象需要实现Serializable接口</section></li></ul>
</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//java对象的写入</span>
<span/>FileOutputStream fileStream = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> FileOutputStream(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"example.txt"</span>);
<span/>ObjectOutputStream out = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> ObjectOutputStream(fileStream);
<span/>Example example = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> Example();
<span/>out.writeObject(example);
<span/>
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//java对象的读取</span>
<span/>FileInputStream fileStream = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> FileInputStream(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"example.txt"</span>);
<span/>ObjectInputStream in = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> ObjectInputStream(fileStream);
<span/>Example = (Example) in.readObject();
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">PipedInputStream和PipedOutputStream
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">管道流，适用在两个线程中传输数据，一个线程通过管道输出流发送数据，另一个线程通过管道输入流读取数据，实现两个线程间的数据通信</section></li></ul>
</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">// 创建一个发送者对象</span>
<span/>Sender sender = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> Sender(); <span class="hljs-comment" style="color: #007400; line-height: 26px;">// 创建一个接收者对象</span>
<span/>Receiver receiver = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> Receiver(); <span class="hljs-comment" style="color: #007400; line-height: 26px;">// 获取输出管道流</span>
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">// 获取输入输出管道流</span>
<span/>PipedOutputStream outputStream = sender.getOutputStream(); 
<span/>PipedInputStream inputStream = receiver.getInputStream();
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">// 链接两个管道，这一步很重要，把输入流和输出流联通起来  </span>
<span/>outputStream.connect(inputStream);
<span/>sender.start();<span class="hljs-comment" style="color: #007400; line-height: 26px;">// 启动发送者线程</span>
<span/>receiver.start();<span class="hljs-comment" style="color: #007400; line-height: 26px;">// 启动接收者线程</span>
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">SequenceInputStream
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">把多个InputStream合并为一个InputStream，允许应用程序把几个输入流连续地合并起来</section></li></ul>
</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;">InputStream in1 = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> FileInputStream(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"example1.txt"</span>);
<span/>InputStream in2 = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> FileInputStream(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"example2.txt"</span>);
<span/>SequenceInputStream sequenceInputStream = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> SequenceInputStream(in1, in2);
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//数据读取</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">int</span> data = sequenceInputStream.read();
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">FilterInputStream和FilterOutputStream 使用了装饰者模式来增加流的额外功能，子类构造参数需要一个InputStream/OutputStream</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;">ByteArrayOutputStream out = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> ByteArrayOutputStream(<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">2014</span>);
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//数据写入，使用DataOutputStream装饰一个InputStream</span>
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//使用InputStream具有对基本数据的处理能力</span>
<span/>DataOutputStream dataOut = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> DataOutputStream(out);
<span/>dataOut.writeDouble(<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">1.0</span>);
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//数据读取</span>
<span/>ByteArrayInputStream in = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> ByteArrayInputStream(out.toByteArray());
<span/>DataInputStream dataIn = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> DataInputStream(in);
<span/>Double data = dataIn.readDouble();
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">DataInputStream和DataOutputStream (Filter流的子类)
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">为其他流附加处理各种基本类型数据的能力,如byte、int、String</section></li></ul>
</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">BufferedInputStream和BufferedOutputStream (Filter流的子类)
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">为其他流增加缓冲功能</section></li></ul>
</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">PushBackInputStream (FilterInputStream子类)
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">推回输入流，可以把读取进来的某些数据重新回退到输入流的缓冲区之中</section></li></ul>
</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">PrintStream (FilterOutputStream子类)
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">打印流，功能类似System.out.print</section></li></ul>
</section></li></ul>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">2 JAVA.IO字符流</span><span class="suffix"></span></h1>
<figure data-tool="mdnice编辑器" style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"><img src="http://ww1.sinaimg.cn/large/0064jPu8ly1ghbniqwgetj30pn0dfgn5.jpg" alt="21.png" style="display: block; margin: 0 auto; max-width: 100%;"><figcaption style="margin-top: 5px; text-align: center; color: #888; font-size: 14px;">21.png</figcaption></figure>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">从字节流和字符流的导向图来，它们之间是相互对应的，比如CharArrayReader和ByteArrayInputStream</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"><strong style="font-weight: bold; color: black;">字节流和字符流的转化：InputStreamReader可以将InputStream转为Reader,OutputStreamReader可以将OutputStream转为Writer</strong></section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//InputStream转为Reader</span>
<span/>InputStream inputStream = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> ByteArrayInputStream(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"程序"</span>.getBytes());
<span/>InputStreamReader reader = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> InputStreamReader(inputStream, StandardCharsets.UTF_8);
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//OutputStream转为Writer</span>
<span/>OutputStream out = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> FileOutputStream(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"example.txt"</span>);
<span/>OutputStreamWriter writer = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> OutputStreamWriter(out);
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//以字符为单位读写</span>
<span/>writer.write(reader.read(<span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">char</span>[<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">2</span>]));
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">区别：字节流读取单位是字节，字符流读取单位是字符；一个字符由字节组成，如变字长编码UTF-8是由1~4个字节表示</section></li></ul>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">3 乱码问题和字符流</span><span class="suffix"></span></h1>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">字符以不同的编码表示，它的字节长度（字长）是不一样的。如“程”的utf-8编码格式，由[-25][-88][-117]组成。而ISO_8859_1编码则是单个字节[63]</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">平时工作对资源的操作都是面向字节流的，然而数据资源根据不同的字节编码转为字节时，它们的内容是不一样，容易造成乱码问题</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">两种出现乱码场景
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">encode和decode使用的字符编码不一致：资源使用UTF-8编码，而在代码里却使用GBK解码打开</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">使用字节流读取字节数不符合字符规定字长：字符是由字节组成的，比如“程”的utf-8格式是三个字节；如果在InputStream里以每两个字节读取流，再转为String（java默认编码是utf-8），此时会出现乱码（半个中文，你猜是什么）</section></li></ul>
</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;">ByteArrayInputStream in = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> ByteArrayInputStream(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"程序大法好"</span>.getBytes());
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">byte</span>[] buf = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">byte</span>[<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">2</span>]; <span class="hljs-comment" style="color: #007400; line-height: 26px;">//读取流的两个字节</span>
<span/>in.read(buf); <span class="hljs-comment" style="color: #007400; line-height: 26px;">//读取数据</span>
<span/>System.out.println(<span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> String(buf)); <span class="hljs-comment" style="color: #007400; line-height: 26px;">//乱码</span>
<span/>---result---- 
<span/>�  <span class="hljs-comment" style="color: #007400; line-height: 26px;">//乱码</span>
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">乱码场景1，知道资源的字符编码，就可以使用对应的字符编码来解码解决</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">乱码场景2，<strong style="font-weight: bold; color: black;">可以一次性读取所有字节，再一次性编码处理。但是对于大文件流，这是不现实的，因此有了字符流的出现</strong></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">字节流使用InputStreamReader、OutputStreamReader转化为字符流，其中可以指定字符编码，再以字符为单位来处理，可解决乱码</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;">InputStreamReader reader = 
<span/>      <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> InputStreamReader(inputStream, StandardCharsets.UTF_8);
<span/></code></pre>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">4 字符集和字符编码的概念区分</span><span class="suffix"></span></h1>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"><strong style="font-weight: bold; color: black;">字符集和字符编码的关系，字符集是规范，字符编码是规范的具体实现</strong>；字符集规定了符号和二进制代码值的唯一对应关系，但是没有指定具体的存储方式；</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">unicode、ASCII、GB2312、GBK都是字符集；<strong style="font-weight: bold; color: black;">其中ASCII、GB2312、GBK既是字符集也是字符编码；注意不混淆这两者区别</strong>；而unicode的具体实现有UTF-8，UTF-16，UTF-32</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">最早出现的ASCII码是使用一个字节（8bit）来规定字符和二进制映射关系，标准ASCII编码规定了128个字符，在英文的世界，是够用的。但是中文，日文等其他文字符号怎么映射呢？因此其他更大的字符集出现了</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">unicode（统一字符集），早期时它使用2个byte表示1个字符，整个字符集可以容纳65536个字符。然而仍然不够用，于是扩展到4个byte表示一个字符，现支持范围是U+010000~U+10FFFF</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">unicode是两个字节的说法是错误的；<strong style="font-weight: bold; color: black;">UTF-8是变字长的，需要用1~4个字节存储；UTF-16一般是两个字节（U+0000~U+FFFF范围），如果遇到两个字节存不下，则用4个字节；而UTF-32是固定四个字节</strong></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">unicode表示的字符，会用“U+”开头，后面跟着十六进制的数字，如“字”的编码就是U+5B57</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">UTF-8 编码和unicode字符集</section></li></ul>
<section class="table-container" data-tool="mdnice编辑器" style="overflow-x: auto;"><table style="display: table; text-align: left;">
<thead>
<tr style="border: 0; border-top: 1px solid #ccc; background-color: white;">
<th style="font-size: 16px; padding: 5px 10px; text-align: left; font-weight: bold; border: 1px solid #009688; background-color: #009688; color: #f8f8f8; border-bottom: 0; min-width: 85px;">范围</th>
<th style="font-size: 16px; padding: 5px 10px; text-align: left; font-weight: bold; border: 1px solid #009688; background-color: #009688; color: #f8f8f8; border-bottom: 0; min-width: 85px;">Unicode(Binary)</th>
<th style="font-size: 16px; padding: 5px 10px; text-align: left; font-weight: bold; border: 1px solid #009688; background-color: #009688; color: #f8f8f8; border-bottom: 0; min-width: 85px;">UTF-8编码(Binary)</th>
<th style="font-size: 16px; padding: 5px 10px; text-align: left; font-weight: bold; border: 1px solid #009688; background-color: #009688; color: #f8f8f8; border-bottom: 0; min-width: 85px;">UTF-8编码byte长度</th>
</tr>
</thead>
<tbody style="border: 0;">
<tr style="border: 0; border-top: 1px solid #ccc; background-color: white;">
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">U+0000~U+007F</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">00000000 00000000 00000000 0XXXXXXX</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">0XXXXXX</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">1</td>
</tr>
<tr style="border: 0; border-top: 1px solid #ccc; background-color: #f8f8f8;">
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">U+0080~U+07FF</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">00000000 00000000 00000YYY YYXXXXXX</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">110YYYYY 10XXXXXX</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">2</td>
</tr>
<tr style="border: 0; border-top: 1px solid #ccc; background-color: white;">
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">U+0800~U+FFFF</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">00000000 00000000 ZZZZYYYY YYXXXXXX</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">1110ZZZZ 10YYYYYY 10XXXXXX</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">3</td>
</tr>
<tr style="border: 0; border-top: 1px solid #ccc; background-color: #f8f8f8;">
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">U+010000~U+10FFFF</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">00000000 000AAAZZ ZZZZYYYY YYXXXXXX</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">11110AAA 10ZZZZZZ 10YYYYYY 10XXXXXX</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">4</td>
</tr>
</tbody>
</table>
</section><ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">程序是分内码和外码，java的默认编码是UTF-8，其实指的是外码；<strong style="font-weight: bold; color: black;">内码倾向于使用定长码，和内存对齐一个原理，便于处理。外码倾向于使用变长码，变长码将常用字符编为短编码，罕见字符编为长编码，节省存储空间与传输带宽</strong></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">JDK8的字符串，是使用char[]来存储字符的，char是两个字节大小，其中使用的是UTF-16编码（内码）。<strong style="font-weight: bold; color: black;">而unicode规定的中文字符在U+0000~U+FFFF内，因此使用char（UTF-16编码）存储中文是不会出现乱码的</strong></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">JDK9后，<strong style="font-weight: bold; color: black;">字符串则使用byte[]数组来存储，因为有一些字符一个char已经存不了，如emoji表情字符</strong>，使用字节存储字符串更容易拓展</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">JDK9，如果字符串的内容都是ISO-8859-1/Latin-1字符（1个字符1字节），则使用ISO-8859-1/Latin-1编码存储字符串，否则使用UTF-16编码存储数组（2或4个字节）</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;">System.out.println(Charset.defaultCharset()); <span class="hljs-comment" style="color: #007400; line-height: 26px;">//输出java默认编码</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">for</span> (<span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">byte</span> item : <span class="hljs-string" style="color: #c41a16; line-height: 26px;">"程序"</span>.getBytes(StandardCharsets.UTF_16)) {
<span/>    System.out.print(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"["</span> + item + <span class="hljs-string" style="color: #c41a16; line-height: 26px;">"]"</span>);
<span/>}
<span/>System.out.println(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">""</span>);
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">for</span> (<span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">byte</span> item : <span class="hljs-string" style="color: #c41a16; line-height: 26px;">"程序"</span>.getBytes(StandardCharsets.UTF_8)) {
<span/>    System.out.print(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"["</span> + item + <span class="hljs-string" style="color: #c41a16; line-height: 26px;">"]"</span>);
<span/>}
<span/>----result----
<span/>UTF-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">8</span>       <span class="hljs-comment" style="color: #007400; line-height: 26px;">//java默认编码UTF-8</span>
<span/>[-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">2</span>][-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">1</span>][<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">122</span>][<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">11</span>][<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">94</span>][-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">113</span>] <span class="hljs-comment" style="color: #007400; line-height: 26px;">//UTF_16：6个字节？</span>
<span/>[-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">25</span>][-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">88</span>][-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">117</span>][-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">27</span>][-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">70</span>][-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">113</span>] <span class="hljs-comment" style="color: #007400; line-height: 26px;">//UTF_8：6个字节 正常</span>
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">“程序”的UTF-16编码竟是输出6个字节，多出了两个字节，这是什么情况？再试试一个字符的输出</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">for</span> (<span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">byte</span> item : <span class="hljs-string" style="color: #c41a16; line-height: 26px;">"程"</span>.getBytes(StandardCharsets.UTF_16)) {
<span/>    System.out.print(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"["</span> + item + <span class="hljs-string" style="color: #c41a16; line-height: 26px;">"]"</span>);
<span/>}
<span/>---result--
<span/>[-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">2</span>][-<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">1</span>][<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">122</span>][<span class="hljs-number" style="color: #1c00cf; line-height: 26px;">11</span>]
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">可以看出UTF-16编码的字节是多了[-2][-1]两个字节，十六进制是0xFEFF。而它用来标识编码顺序是<strong style="font-weight: bold; color: black;">Big endian</strong>还是<strong style="font-weight: bold; color: black;">Little endian</strong>。以字符'中'为例，它的unicode十六进制是4E2D，存储时4E在前，2D在后，就是Big endian；2D在前，4E在后，就是Little endian。FEFF表示存储采用Big endian，FFFE表示使用Little endian</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">为什么UTF-8没有字节序的问题呢？<strong style="font-weight: bold; color: black;">个人看法，因为UTF-8是变长的，由第一个字节的头部的0、110、1110、11110判断是否需后续几个字节组成字符，使用Big endian易读取处理</strong>，反过来不好处理，因此强制用Big endian</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">其实感觉UTF-16可以强制规定用Big endian；但这其中历史问题。。。</section></li></ul>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">5 URI概念的简单介绍</span><span class="suffix"></span></h1>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">既然有了java.io来操作资源流；但是对于网络的资源，该怎么打开，怎么定位呢？答URI-URL</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">URI全称是<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #009688;">Uniform Resource Identifier</code> 统一资源标识符</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">通俗说，就是一个类似身份证号码的字符串，只不过它是用来标识资源(如：邮件地址，主机名，文件等)</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">URI 具有特定的规则: <code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #009688;">[scheme]:[scheme-specific-part][#fragment]</code>
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">进一步细入划分可表示为<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #009688;">[scheme]:[//authority][/path][?query][#fragment]</code>，其中模式特定部分为authority和path、query；而authority可以看做域名，如<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #009688;">www.baidu.com</code></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">终极细分则是<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #009688;">[scheme]:[//host:port][/path][?query][#fragment]</code>，和日常见到的地址链接一毛一样了</section></li></ul>
</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"><strong style="font-weight: bold; color: black;">模式特定部分(scheme-specific-part)的形式取决于模式</strong>，而URI的常用模式如下
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">ftp：FTP服务器</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">file：本地磁盘上的文件</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">http：使用超文本传输协议</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">mailto：电子邮件的地址</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">telnet：基于Telnet的服务的连接</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">Java中还大量使用了一些非标准的定制模式，如rmi、jar、jndi、doc、jdbc等</section></li></ul>
</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">在java中URI抽象为java.net.URI类，下面列举几种常用构造方法</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//根据str生成URI</span>
<span/><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">URI</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">(String str)</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> URISyntaxException
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">URI</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">(String scheme, String authority,
<span/>       String path, String query, String fragment)</span><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> URISyntaxException
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">static</span> URI <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">create</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">(String str)</span> <span class="hljs-comment" style="color: #007400; line-height: 26px;">//调用 URI(String str)   </span>
<span/></span></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">JAVA.URI的常用操作方法</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> String <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getScheme</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span>    <span class="hljs-comment" style="color: #007400; line-height: 26px;">//获取模式</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> String <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getSchemeSpecificPart</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span><span class="hljs-comment" style="color: #007400; line-height: 26px;">//获取模式特定部分</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> String <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getFragment</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span>  <span class="hljs-comment" style="color: #007400; line-height: 26px;">//获取片段标识符</span>
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//以上三个方法是通用的</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> String <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getAuthority</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span> <span class="hljs-comment" style="color: #007400; line-height: 26px;">//授权机构,如www.baidu.com</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> String <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getHost</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span>      <span class="hljs-comment" style="color: #007400; line-height: 26px;">//获取主机部分,如127.0.0.1</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">int</span> <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getPort</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span>         <span class="hljs-comment" style="color: #007400; line-height: 26px;">//如8080</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> String <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getPath</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span>      <span class="hljs-comment" style="color: #007400; line-height: 26px;">//定位路径</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> String <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getQuery</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span>     <span class="hljs-comment" style="color: #007400; line-height: 26px;">//查询条件</span>
<span/></span></code></pre>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">6 URL概念及与URL的区别</span><span class="suffix"></span></h1>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">URL全称是<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #009688;">Uniform Resource Location</code>，统一资源定位符</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">URL就是URI的子集，它除了标识资源，还提供找到资源的路径；<strong style="font-weight: bold; color: black;">在Java类库中，URI类不包含任何访问资源的方法，它唯一的作用就是解析，而URL类可以打开一个到达资源的流</strong></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">同属URI子集的URN(统一资源名称)，<strong style="font-weight: bold; color: black;">只标识资源名称，却不指定如何定位资源</strong>；如：<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #009688;">mailto：clswcl@gmail.com</code>就是一种URN，知道这是个邮箱，却不知道该怎么查找定位</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"><strong style="font-weight: bold; color: black;">通俗就是，URN告诉你有一个地方叫广州，但没有说怎么去，你可以搭动车，也可以搭飞机；URL会告诉你坐飞机去广州，而另一URL则说搭动车去</strong></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">URL的一般语法规则</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;">协议://主机名:端口/路径?查询<span class="hljs-comment" style="color: #007400; line-height: 26px;">#片段</span>
<span/>[protocol]:[//host:port][/path][?query][<span class="hljs-comment" style="color: #007400; line-height: 26px;">#fragment]</span>
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">URL的构造方法、获取方法</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//基于URL模式构造URL实例</span>
<span/><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">URL</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">(String spec)</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> MalformedURLException
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//其中file相当于path、query和fragment三个部分组成</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">URL</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">(String protocol, String host, <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">int</span> port, String file)</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> MalformedURLException
<span/>
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//根据类加载器获取URL</span>
<span/>URL systemResource </span>= ClassLoader.getSystemResource(String name)
<span/>Enumeration&lt;URL&gt; systemResources = ClassLoader.getSystemResources(String name)
<span/>URL resource = Main.class.getResource(String name)
<span/>Enumeration&lt;URL&gt; resources = Main.class.getClassLoader().getResources(String name)
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">通过URL获取资源数据的操作函数</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">final</span> InputStream <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">openStream</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> java.io.IOException
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> URLConnection <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">openConnection</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> java.io.IOException
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">final</span> Object <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getContent</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> java.io.IOException
<span/></span></code></pre>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">7 Spring.Resource与Spring资源获取方式</span><span class="suffix"></span></h1>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">讲到资源，就得提下Spring获取资源方式，常用的有两种
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">通过Resource接口的子类获取资源</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">通过ResourceLoader接口的子类获取资源</section></li></ul>
</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">Spring.Resource 资源操作函数一览</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//判断资源是否存在</span>
<span/><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">boolean</span> <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">exists</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span></span>; <span class="hljs-comment" style="color: #007400; line-height: 26px;">//</span>
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//返回当前资源对应的URL,不能解析则会抛出异常;如ByteArrayResource就不能解析为一个URL</span>
<span/><span class="hljs-function" style="line-height: 26px;">URL <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getURL</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> IOException</span>;
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//返回当前资源对应的URI</span>
<span/><span class="hljs-function" style="line-height: 26px;">URI <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getURI</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> IOException</span>;
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//返回当前资源对应的File</span>
<span/><span class="hljs-function" style="line-height: 26px;">File <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getFile</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> IOException</span>;
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//返回对应的ReadableByteChannel</span>
<span/><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">default</span> ReadableByteChannel <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">readableChannel</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> IOException
<span/></span></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">介绍下Resource相关子类的使用</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">1 <strong style="font-weight: bold; color: black;">FileSystemResource</strong>：通过文件系统获取资源</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;">Resource resource = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> FileSystemResource(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"D:/example.txt"</span>);
<span/>File file= <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> File(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"example.txt"</span>);
<span/>Resource resource2 = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> FileSystemResource(file);
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">2 <strong style="font-weight: bold; color: black;">ByteArrayResource</strong>：获取byte数组表示的资源
<ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: square;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">基于ByteArrayInputStream和字节数组实现，应用场景类似ByteArrayInputStream，缓存byte[]资源</section></li></ul>
</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">3 <strong style="font-weight: bold; color: black;">ClassPathResource</strong>：获取类路径下的资源</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//ClassPathResource.java 的三个属性</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">private</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">final</span> String path;
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//使用Class或ClassLoader加载资源</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">private</span> ClassLoader classLoader;
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">private</span> Class&lt;?&gt; clazz;
<span/>
<span/>---使用方式----
<span/>Resource resource = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> ClassPathResource(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"test.txt"</span>);
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">4 <strong style="font-weight: bold; color: black;">InputStreamResource</strong>：接收一个InputStream对象，获取输入流封装的资源</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">5 <strong style="font-weight: bold; color: black;">ServletContextResourse</strong>：加载ServletContext环境下（相对于Web应用根目录的）路径资源，获取的资源</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">6 <strong style="font-weight: bold; color: black;">UrlResource</strong>：通过URL访问http资源和FTP资源等</section></li></ul>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">8 ResourceLoader 获取资源</span><span class="suffix"></span></h1>
<figure data-tool="mdnice编辑器" style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"><img src="http://ww1.sinaimg.cn/large/0064jPu8ly1ghca7c4hbcj30p109it8y.jpg" alt="resource.png" style="display: block; margin: 0 auto; max-width: 100%;"><figcaption style="margin-top: 5px; text-align: center; color: #888; font-size: 14px;">resource.png</figcaption></figure>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">ResourceLoader是为了屏蔽了Resource的具体实现，统一资源的获取方式。你即能从ResourceLoader加载ClassPathResource，也能加载FileSystemResource等</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-class" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">interface</span> <span class="hljs-title" style="color: #5c2699; line-height: 26px;">ResourceLoader</span> </span>{
<span/>  <span class="hljs-comment" style="color: #007400; line-height: 26px;">// 默认从类路径加载的资源 前缀: "classpath:"，获取ClassPathResource</span>
<span/>   String CLASSPATH_URL_PREFIX = ResourceUtils.CLASSPATH_URL_PREFIX;
<span/>  <span class="hljs-function" style="line-height: 26px;">Resource <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">getResource</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">(String location)</span>；
<span/></span></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">ResourceLoader接口默认对classpath路径下面的资源进行加载</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-class" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">interface</span> <span class="hljs-title" style="color: #5c2699; line-height: 26px;">ResourcePatternResolver</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">extends</span> <span class="hljs-title" style="color: #5c2699; line-height: 26px;">ResourceLoader</span> </span>{
<span/>  <span class="hljs-comment" style="color: #007400; line-height: 26px;">// 默认加载所有路径（包括jar包）下面的文件，"classpath*:"， 获取ClassPathResource</span>
<span/>  String CLASSPATH_ALL_URL_PREFIX = <span class="hljs-string" style="color: #c41a16; line-height: 26px;">"classpath*:"</span>;
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">ResourcePatternResolver默认会加载所有路径下面的文件，获得ClassPathResource；<strong style="font-weight: bold; color: black;">classpath：只会在class类路径下查找；而classpath*：会扫描所有JAR包及class类路径下出现的文件</strong></section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//Ant风格表达式  com/smart/**/*.xml </span>
<span/>ResourcePatternResoler resolver = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> PathMatchingResourcePatternResolver();
<span/>Resource resources[] = resolver.getResources(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"com/smart/**/*.xml"</span>);
<span/>
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">// ApplicationContext ctx </span>
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//FileSystemResource资源</span>
<span/>Resource template = ctx.getResource(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"file:///res.txt"</span>);
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//UrlResource资源</span>
<span/>Resource template = ctx.getResource(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"https://my.cn/res.txt"</span>);
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">ResourceLoader方法getResource的locationPattern可设置资源模式前缀来获取非ClassPathResource资源，locationPattern支持Ant风格</section></li></ul>
<section class="table-container" data-tool="mdnice编辑器" style="overflow-x: auto;"><table style="display: table; text-align: left;">
<thead>
<tr style="border: 0; border-top: 1px solid #ccc; background-color: white;">
<th style="font-size: 16px; padding: 5px 10px; text-align: left; font-weight: bold; border: 1px solid #009688; background-color: #009688; color: #f8f8f8; border-bottom: 0; min-width: 85px;">前缀</th>
<th style="font-size: 16px; padding: 5px 10px; text-align: left; font-weight: bold; border: 1px solid #009688; background-color: #009688; color: #f8f8f8; border-bottom: 0; min-width: 85px;">示例</th>
<th style="font-size: 16px; padding: 5px 10px; text-align: left; font-weight: bold; border: 1px solid #009688; background-color: #009688; color: #f8f8f8; border-bottom: 0; min-width: 85px;">描述</th>
</tr>
</thead>
<tbody style="border: 0;">
<tr style="border: 0; border-top: 1px solid #ccc; background-color: white;">
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">classpath:</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">classpath:config.xml</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">从类路径加载</td>
</tr>
<tr style="border: 0; border-top: 1px solid #ccc; background-color: #f8f8f8;">
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">file:</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">file:///res.txt</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">从文件系统加载FileSystemResource</td>
</tr>
<tr style="border: 0; border-top: 1px solid #ccc; background-color: white;">
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">http:</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">http://my.cn/res.txt</td>
<td style="font-size: 16px; padding: 5px 10px; text-align: left; border: 1px solid #009688; min-width: 85px;">加载UrlResource</td>
</tr>
</tbody>
</table>
</section><h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">9 JAVA.Properties了解一下</span><span class="suffix"></span></h1>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">Properties是java自带的配置处理类；Properties加载资源的两种方式</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-class" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">class</span> <span class="hljs-title" style="color: #5c2699; line-height: 26px;">Properties</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">extends</span> <span class="hljs-title" style="color: #5c2699; line-height: 26px;">Hashtable</span>&lt;<span class="hljs-title" style="color: #5c2699; line-height: 26px;">Object</span>,<span class="hljs-title" style="color: #5c2699; line-height: 26px;">Object</span>&gt;</span>{
<span/>    .... <span class="hljs-comment" style="color: #007400; line-height: 26px;">//可根据Reader或者InputStream加载properties文件内容</span>
<span/>    <span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">synchronized</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">void</span> <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">load</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">(Reader reader)</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> IOException
<span/>    <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">synchronized</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">void</span> <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">load</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">(InputStream inStream)</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> IOException
<span/></span></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">Properties读取配置示例代码</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//res.properties</span>
<span/>username = root
<span/>password = password
<span/>-------代码示例-------------
<span/>InputStream input = ClassLoader.getSystemResourceAsStream(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"res.properties"</span>);
<span/>Properties prop = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> Properties();
<span/>prop.load(inputStream); <span class="hljs-comment" style="color: #007400; line-height: 26px;">//根据inputStream载入资源</span>
<span/>String username = prop.getProperty(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"username"</span>);
<span/></code></pre>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">10 yml配置资源的读取</span><span class="suffix"></span></h1>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">普通java项目如果需要读取yml可引入jackson-dataformat-yaml，而springboot默认配置支持yml的读取</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;">&lt;dependency&gt;
  &lt;groupId&gt;com.fasterxml.jackson.dataformat&lt;/groupId&gt;
  &lt;artifactId&gt;jackson-dataformat-yaml&lt;/artifactId&gt;
  &lt;version&gt;2.9.5&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">基于jackson-dataformat-yaml对yml配置资源的读取</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//res.yml 配置</span>
<span/>name: chen
<span/>params:
<span/>  url:  http:<span class="hljs-comment" style="color: #007400; line-height: 26px;">//www.my.com</span>
<span/>  
<span/>----------代码示例---------------
<span/>InputStream input = ClassLoader.getSystemResourceAsStream(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"res.yml"</span>);
<span/>Yaml yml = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> Yaml();
<span/>Map map = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> Yaml().loadAs(input, LinkedHashMap.class);; <span class="hljs-comment" style="color: #007400; line-height: 26px;">//根据inputStream载入资源</span>
<span/>String name = MapUtils.getString(map,<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"name"</span>); <span class="hljs-comment" style="color: #007400; line-height: 26px;">// chen</span>
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//url:  http://www.my.com</span>
<span/>String url = MapUtils.getString((Map)map.get(<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"params"</span>),<span class="hljs-string" style="color: #c41a16; line-height: 26px;">"url"</span>)
<span/></code></pre>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">11 优雅地关闭资源，try-with-resource语法和lombok@Cleanup</span><span class="suffix"></span></h1>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">资源的打开就需要对应的关闭，但我们常会忘记关闭资源，或在多处代码关闭资源感到杂乱，有没有简洁的关闭方法呢？</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">自动关闭资源类需实现AutoCloseable接口和配和try-with-resource语法糖使用</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-class" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">class</span> <span class="hljs-title" style="color: #5c2699; line-height: 26px;">YSOAPConnection</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">implements</span> <span class="hljs-title" style="color: #5c2699; line-height: 26px;">AutoCloseable</span> </span>{
<span/>    <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">private</span> SOAPConnection connection;
<span/>    <span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">static</span> YSOAPConnection <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">open</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">(SOAPConnectionFactory soapConnectionFactory)</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> SOAPException  </span>{
<span/>        YSOAPConnection ySoapConnection = <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">new</span> YSOAPConnection();
<span/>        SOAPConnection connection = soapConnectionFactory.createConnection();
<span/>        ySoapConnection.setConnection(connection);
<span/>        <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">return</span> ySoapConnection;
<span/>    }
<span/>    <span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> SOAPMessage <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">call</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">(SOAPMessage request, Object to)</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> SOAPException </span>{
<span/>        <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">return</span> connection.call(request, to); 
<span/>    }
<span/>    <span class="hljs-meta" style="color: #643820; line-height: 26px;">@Override</span>
<span/>    <span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">public</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">void</span> <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">close</span><span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> SOAPException </span>{
<span/>        <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">if</span> (connection != <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">null</span>) {  connection.close(); }
<span/>    }
<span/>}
<span/></code></pre>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//自动关闭的资源类使用示例</span>
<span/><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">try</span> (YSOAPConnection soapConnection=YSOAPConnection.open(soapConnectionFactory)){
<span/>    SOAPMessage soapResponse = soapConnection.call(request, endpoint);
<span/>    ...<span class="hljs-comment" style="color: #007400; line-height: 26px;">//数据操作</span>
<span/>} <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">catch</span> (Exception e) {
<span/>    log.error(e.getMessage(), e);
<span/>    ...
<span/>}
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">lombok注解@Cleanup，对象生命周期结束时会调用<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #009688;">public void close()</code>;对象需实现AutoCloseable接口</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">import</span> lombok.Cleanup;
<span/><span class="hljs-meta" style="color: #643820; line-height: 26px;">@Cleanup</span>  <span class="hljs-comment" style="color: #007400; line-height: 26px;">// @Cleanup的使用</span>
<span/>YSOAPConnection soapConnection=YSOAPConnection.open(soapConnectionFactory)
<span/></code></pre>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">12 资源不关闭，会导致什么最坏的结果</span><span class="suffix"></span></h1>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">JDK的原生资源类不关闭，它也不会永远存在。JVM会借助finalize自动关闭它，例如FileInputStream</section></li></ul>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://imgkr.cn-bj.ufileos.com/97e4eed2-a992-4976-acf0-ccb6fb34d308.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fff; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: black; display: block; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fff; border-radius: 5px;"><span class="hljs-comment" style="color: #007400; line-height: 26px;">//FileInputStream.java - JDK8</span>
<span/><span class="hljs-comment" style="color: #007400; line-height: 26px;">//jdk8的FileInputStream重写了finalize，保证对象回收前开启的资源被关闭</span>
<span/><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">protected</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">void</span> <span class="hljs-title" style="color: #1c00cf; line-height: 26px;">finalize</span> <span class="hljs-params" style="color: #5c2699; line-height: 26px;">()</span> <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">throws</span> IOException </span>{
<span/>    <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">if</span> (guard != <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">null</span>) {
<span/>        guard.warnIfOpen();
<span/>    }
<span/>    <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">if</span> ((fd != <span class="hljs-keyword" style="color: #aa0d91; line-height: 26px;">null</span>) &amp;&amp; (fd != FileDescriptor.in)) {
<span/>        close();
<span/>    }
<span/>}
<span/></code></pre>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">在JDK9后，用Cleaner机制代替了finalize机制；Cleaner机制自动回收的对象同样需要实现AutoCloseable接口；Cleaner是基于PhantomReference实现的；对实现细节感兴趣的同学，可自行查阅下相关文档</section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">但是使用JDK的提供的资源关闭机制的，那么资源的关闭比手动关闭时要延后很长时间的。据测试，<strong style="font-weight: bold; color: black;">使用try-with-resources关闭资源，并让垃圾回收器回收它的时间在12纳秒。而使用finalizer机制，时间增加到550纳秒</strong></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">不及时关闭资源，就会占用资源，影响其他线程的执行；比如linux的文件资源，linux进程默认能打开的最大文件数是1024（有的是2048，此数值是可配置的）；如果一个线程持有十几个文件资源，还要等550纳秒用finalizer机制释放资源，同进程的其他线程都等到花谢了</section></li></ul>
<hr data-tool="mdnice编辑器" style="height: 1px; margin-top: 10px; margin-bottom: 10px; border: none; border-top: 1px solid black; margin: 20px 0;">
<h2 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 22px; color: #009688; padding-left: 10px; margin: 1em auto; border-left: 3px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">欢迎指正文中错误</span><span class="suffix"></span></h2>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">关注公众号，一起交流</span><span class="suffix"></span></h1>
<figure data-tool="mdnice编辑器" style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"><img src="https://user-gold-cdn.xitu.io/2020/7/19/17367b94da0e9fd2?w=1013&amp;h=451&amp;f=png&amp;s=212256" alt style="display: block; margin: 0 auto; max-width: 100%;"></figure>
<h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; font-size: 1.8em; color: #009688; margin: 1.2em auto; text-align: center; border-bottom: 1px solid #009688;"><span class="prefix" style="display: none;"></span><span class="content">参考文章</span><span class="suffix"></span></h1>
<ul data-tool="mdnice编辑器" style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;">
<li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"><a href="https://www.cnblogs.com/thatme/p/10246837.html" style="text-decoration: none; word-wrap: break-word; font-weight: bold; color: #009688; border-bottom: 1px solid #009688;">从源码角度理解Java设计模式——装饰者模式</a></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"><a href="https://blog.csdn.net/qq_24434671/article/details/90206417" style="text-decoration: none; word-wrap: break-word; font-weight: bold; color: #009688; border-bottom: 1px solid #009688;">Java中的管道流</a></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"><a href="https://blog.csdn.net/cslucifer/article/details/76595449" style="text-decoration: none; word-wrap: break-word; font-weight: bold; color: #009688; border-bottom: 1px solid #009688;">InputStream乱码问题的解决方法</a></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"><a href="https://blog.csdn.net/androidyue/article/details/106545450" style="text-decoration: none; word-wrap: break-word; font-weight: bold; color: #009688; border-bottom: 1px solid #009688;">未关闭的文件流会引起内存泄露么？</a></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"><a href="https://blog.csdn.net/muddledape/article/details/80868981" style="text-decoration: none; word-wrap: break-word; font-weight: bold; color: #009688; border-bottom: 1px solid #009688;">char类型与字符编码</a></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"><a href="https://blog.csdn.net/nlznlz/article/details/80950596" style="text-decoration: none; word-wrap: break-word; font-weight: bold; color: #009688; border-bottom: 1px solid #009688;">结合Java详谈字符编码和字符集</a></section></li><li><section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"><a href="https://blog.csdn.net/Sword52888/article/details/101542032" style="text-decoration: none; word-wrap: break-word; font-weight: bold; color: #009688; border-bottom: 1px solid #009688;">Cleaner 对比 finalize 对比 AutoCloseable</a></section></li></ul>
</section>